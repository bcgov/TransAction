#!/bin/bash

# Overrdie package.json's homepage field if DEPLOY_SUBDIRECTORY is set
# Only for frontend client, therefore checks for NodeJS builder image
if [ -n "$DEPLOY_SUBDIRECTORY" ] && [ -n "$NODEJS_SCL" ]; then
    echo "---> Replacing package.json homepage field with $DEPLOY_SUBDIRECTORY"
    
    sed -i 's~"homepage": "/"~"homepage": "'"$DEPLOY_SUBDIRECTORY"'"~1' /tmp/src/package.json
fi

# Execute the default S2I script
source ${STI_SCRIPTS_PATH}/assemble

